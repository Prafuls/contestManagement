<!DOCTYPE html>

<html lang="en-US">
<head>
	<title>Data Viewer | Dulles TMSCA Tournament</title>
	<meta name="description" content="View the Dulles High School TMSCA Tournament Data including registrations, users, requested clarifications, and scores">
	<meta name="robots" content="noindex, nofollow">
	#include("head.html")
	<style type="text/css">
	body { padding-top: 60px; } /* 60px to make the container go all the way to the bottom of the topbar */
	#if($registration)
		.container,
		.navbar-static-top .container,
		.navbar-fixed-top .container,
		.navbar-fixed-bottom .container { width: 1280px; }
		@media print { @page { size: landscape; } }
		
	#elseif($scores)
		@media print {
			.span2 * { visibility: hidden; }
			.span8 * { visibility: visible; }
			.span8 {
				position: absolute;
				left: 0;
				top: 0;
				width: 100% !important;
			}
			@page {	size: potrait; }
			h1 .btn { display: none; }
		}
		h1 button { float: right; }
		
	#elseif($questions)
		@media print { @page { size: landscape; } }
	#end
	</style>
</head>

<body>
	#parse("navbar.html") 
	#if($scores)
	<div class="container-fluid">
		<noscript>Please enable JavaScript, otherwise numerous areas of this website will be
			nonfunctional.</noscript>

		<div class="row-fluid">
			<div class="span1"></div>
			<div class="span2">
				<ul class="nav nav-list navbar-inverse">
					<li id="overview"><a href="/data?choice=scores">Overview</a></li>
					<li class="nav-header">Middle School</li>
					<li id="middle_students"><a href="/data?choice=scores&type=middle_students">All Students</a></li>
					<li id="middle_sweep"><a href="/data?choice=scores&type=middle_sweep">Sweepstakes</a></li>
					<li id="middle_categorySweep"><a href="/data?choice=scores&type=middle_categorySweep">Category
							Sweekstakes</a></li>
					<li class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown">Schools<b
							class="caret"></b></a>
						<ul class="dropdown-menu">
							#foreach($school in $middleSchools)
							<li id="$school.getProperty("school").hashCode()"><a
								href="/data?choice=scores&type=middle_school_$esc.url($school.getProperty("school"))">$school.getProperty("school")</a></li>
							#end
						</ul></li>
					<li class="divider"></li>

					#foreach($num in [6..8])
					<li id="${num}" class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown">${num}th Grade<b
							class="caret"></b>
					</a>
						<ul class="dropdown-menu">
							<li id="middle_category_${num}C"><a href="/data?choice=scores&type=middle_category_${num}C">Calculator</a></li>
							<li id="middle_category_${num}N"><a href="/data?choice=scores&type=middle_category_${num}N">Number Sense</a></li>
							<li id="middle_category_${num}M"><a href="/data?choice=scores&type=middle_category_${num}M">Math</a></li>
							<li id="middle_category_${num}S"><a href="/data?choice=scores&type=middle_category_${num}S">Science</a></li>
						</ul></li>
					#end

					<li class="nav-header">High School</li>
					<li id="high_students"><a href="/data?choice=scores&type=high_students">All Students</a></li>
					<li id="high_sweep"><a href="/data?choice=scores&type=high_sweep">Sweepstakes</a></li>
					<li id="high_categorySweep"><a href="/data?choice=scores&type=high_categorySweep">Category
							Sweekstakes</a></li>
					<li class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown">Schools<b
							class="caret"></b></a>
						<ul class="dropdown-menu">
							#foreach($school in $highSchools)
							<li id="$school.getProperty("school").hashCode()"><a
								href="/data?choice=scores&type=high_school_$esc.url($school.getProperty("school"))">$school.getProperty("school")</a></li>
							#end
						</ul></li>
					<li class="divider"></li>
	
					#foreach($num in [9..12])
					<li id="${num}" class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown">${num}th Grade<b
							class="caret"></b>
					</a>
						<ul class="dropdown-menu">
							<li id="high_category_${num}C"><a href="/data?choice=scores&type=high_category_${num}C">Calculator</a></li>
							<li id="high_category_${num}N"><a href="/data?choice=scores&type=high_category_${num}N">Number Sense</a></li>
							<li id="high_category_${num}M"><a href="/data?choice=scores&type=high_category_${num}M">Math</a></li>
							<li id="high_category_${num}S"><a href="/data?choice=scores&type=high_category_${num}S">Science</a></li>
						</ul></li>
					#end
				</ul>
			</div>

			<div class="span8">
				<h1>Contest Results
				<button class="btn btn-small">Print<i class="icon-print"></i></button>
				</h1>
				#if( $overview ) Choose an option at the left to view specific results. #elseif(!$html) Results for this
				competition are not yet available #else $html #end
			</div>
		</div>
	</div>
	#else
	<div class="container">
		<noscript>Please enable JavaScript, otherwise numerous areas of this website will be
			nonfunctional.</noscript>
		<h1>Contest Data Viewer &amp; Editor</h1>
		#if($overview)
		<h2>Overview</h2>
		To view, edit, add, and modify registrations, go to the <a href="/data?choice=registrations">Registration
			Data Viewer &amp; Editor</a>. <br /> To view, delete, and respond to clarifications and questions sent through
		the <a href="/contactUs">Contact Us</a> page, go to the <a href="/data?choice=questions">Question Viewer</a>.
		<br /> To view, edit, add, and modify student scores, go to the <a href="/data?choice=scores">Score
			Viewer &amp; Editor</a>. <br /> #elseif($registration) #if($updated)
		<div class="alert alert-success">
			<a class="close" data-dismiss="alert">&times;</a> <strong>Success! </strong>The changes have been committed
			to the database and are reflected below.
		</div>
		#end
		<h2>Recorded Registrations</h2>
		<em>Note:</em> x/y indicates a registration for x tests and y tests actually taken
		<form method="post">
			<h3>Middle School</h3>
			<table class="table table-striped table-condensed table-hover">
				<thead>
					<tr>
						<th>Edit?</th>
						<th>Name</th>
						<th>E-Mail</th>
						<th>Reg. Type</th>
						<th>School</th>
						<th>Aliases</th>
						<th>Account</th> #set($tests = ["6n","6c","6m","6s","7n","7c","7m","7s","8n","8c","8m","8s"])
						#foreach($test in $tests)
						<th>$test</th> #end
						<th>Cost</th>
					</tr>
				</thead>
				<tbody>
					#set($nums = [0,0,0,0,0,0,0,0,0,0,0,0,0]) #foreach($reg in $middleRegs)
					<tr>
						<td style="text-align: center"><input type="radio" name="edit" value="$reg.getKey().getId()"></td>
						<td>$reg.getProperty("name")</td>
						<td><a href="mailto:$reg.getProperty("email")">$reg.getProperty("email")</a></td>
						<td>$reg.getProperty("registrationType")</td>
						<td>$reg.getProperty("schoolName")</td> #if($reg.getProperty("aliases"))
						<td>$reg.getProperty("aliases")</td> #else
						<td></td> #end
						<td>$reg.getProperty("account")</td> #set($tests =
						["6n","6c","6m","6s","7n","7c","7m","7s","8n","8c","8m","8s"]) #set($i = 0) #foreach($test in $tests)
						<td>$reg.getProperty($test)#if($reg.getProperty($test.toUpperCase()))/$reg.getProperty($test.toUpperCase())#else/0
							#end</td> #set($nums[$i] = $nums[$i] + $reg.getProperty($test)) #set($i = $i + 1) #end
						<td>&#36;$reg.getProperty("cost")</td> #set($nums[12] = $nums[12] + $reg.getProperty("cost"))
					</tr>
					#end #set($nums[12] = "&#36;$nums[12]")
					<tr>
						<td><b>Total</b></td>
						<td></td>
						<td></td>
						<td></td>
						<td></td>
						<td></td>
						<td></td> #foreach($num in $nums)
						<td>$num</td> #end
					</tr>
				</tbody>
			</table>

			<h3>High School</h3>
			<table class="table table-striped table-condensed table-hover">
				<thead>
					<tr>
						<th>Edit?</th>
						<th>Name</th>
						<th>E-Mail</th>
						<th>Reg. Type</th>
						<th>School</th>
						<th>Aliases</th>
						<th>Account</th> #set($tests =
						["9n","9c","9m","9s","10n","10c","10m","10s","11n","11c","11m","11s","12n","12c","12m","12s"])
						#foreach($test in $tests)
						<th>$test</th> #end
						<th>Cost</th>
					</tr>
				</thead>
				<tbody>
					#set($nums = [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]) #foreach($reg in $highRegs)
					<tr>
						<td style="text-align: center"><input type="radio" name="edit" value="$reg.getKey().getId()"></td>
						<td>$reg.getProperty("name")</td>
						<td><a href="mailto:$reg.getProperty("email")">$reg.getProperty("email")</a></td>
						<td>$reg.getProperty("registrationType")</td>
						<td>$reg.getProperty("schoolName")</td> #if($reg.getProperty("aliases"))
						<td>$reg.getProperty("aliases")</td> #else
						<td></td> #end
						<td>$reg.getProperty("account")</td> #set($tests =
						["9n","9c","9m","9s","10n","10c","10m","10s","11n","11c","11m","11s","12n","12c","12m","12s"]) #set($i =
						0) #foreach($test in $tests)
						<td>$reg.getProperty($test)#if($reg.getProperty($test.toUpperCase()))/$reg.getProperty($test.toUpperCase())#else/0
							#end</td> #set($nums[$i] = $nums[$i] + $reg.getProperty($test)) #set($i = $i + 1) #end
						<td>&#36;$reg.getProperty("cost")</td> #set($nums[16] = $nums[16] + $reg.getProperty("cost"))
					</tr>
					#end #set($nums[16] = "&#36;$nums[16]")
					<tr>
						<td><b>Total</b></td>
						<td></td>
						<td></td>
						<td></td>
						<td></td>
						<td></td>
						<td></td> #foreach($num in $nums)
						<td>$num</td> #end
					</tr>
				</tbody>
			</table>
			<div class="form-actions">
				<button type="submit" id="submit" class="btn btn-primary">Edit Selected</button>
			</div>
		</form>

		#elseif($questions) #if($updated)
		<div class="alert alert-success">
			<a class="close" data-dismiss="alert">&times;</a> <strong>Success! </strong>The changes have been committed
			to the database and are reflected below.
		</div>
		#end

		<h2>Questions & Clarifications Requested</h2>
		<h3>Unresolved Questions</h3>
		<form method="post">
			<table class="table table-striped table-condensed table-hover">
				<thead>
					<tr>
						<th style="width: 5%">Resolved?</th>
						<th>Name</th>
						<th>E-Mail</th>
						<th>School Name</th>
						<th>Message</th>
					</tr>
				</thead>
				<tbody>
					#foreach($q in $unresolvedQs)
					<tr>
						<td style="text-align: center"><input type="checkbox" name="$q.getKey().getId()" value="r"></td>
						<td>$q.getProperty("name")</td>
						<td><a href="mailto:$q.getProperty("email")">$q.getProperty("email")</a></td>
						<td>$q.getProperty("school")</td>
						<td>$q.getProperty("comment")</td>
					</tr>
					#end
				</tbody>
			</table>
			<h3>Resolved Questions</h3>
			<table class="table table-striped table-condensed table-hover">
				<thead>
					<tr>
						<th style="width: 5%">Delete?</th>
						<th>Name</th>
						<th>E-Mail</th>
						<th>School Name</th>
						<th>Message</th>
					</tr>
				</thead>
				<tbody>
					#foreach($q in $resolvedQs)
					<tr>
						<td style="text-align: center"><input type="checkbox" name="$q.getKey().getId()" value="d"></td>
						<td>$q.getProperty("name")</td>
						<td><a href="mailto:$q.getProperty("email")">$q.getProperty("email")</a></td>
						<td>$q.getProperty("school")</td>
						<td>$q.getProperty("comment")</td>
					</tr>
					#end
				</tbody>
			</table>
			<div class="form-actions">
				<button type="submit" id="submit" class="btn btn-primary">Apply Changes</button>
			</div>
		</form>
		#elseif($overview) hi #else #end #end
	</div>

	<script type="text/javascript" src="/js/jquery.min.js"></script>
	<script type="text/javascript" src="/js/bootstrap-dropdown.js"></script>
	<script type="text/javascript" src="/js/bootstrap-alert.js"></script>
	<script type="text/javascript" src="/js/purl.js"></script>
	<script type="text/javascript">
		$(document).ready(function () {
			#if($scores) 
				ChangeActive();
				$('button').on('click', function() {
					$('button').hide();
					window.print();
					$('button').show();
				});
			#end
		});
	</script>
	<script type="text/javascript">
		function ChangeActive() {
			var type = $.url().param('type');
			if (type == undefined)
				$("#overview").addClass('active');
			else {
				$("#" + type).closest('.dropdown').addClass('active');
				$('#' + type).addClass('active');
				
				if(type.indexOf('middle_school_') != -1 || type.indexOf('high_school_') != -1) {
					var hash = hashCode(type.substring(type.indexOf('school_') + 7));
					$("#" + hash).closest('.dropdown').addClass('active');
					$('#' + hash).addClass('active');
				}
			}
		}
		
		hashCode = function(s){
		    var hash = 0, i, char;
		    if (s.length == 0) return hash;
		    for (i = 0; i < s.length; i++) {
		        char = s.charCodeAt(i);
		        hash = ((hash<<5)-hash)+char;
		        hash = hash & hash; // Convert to 32bit integer
		    }
		    return hash;
		};
	</script>
	<script>
		$(document).ready(
			function() {
				$("input:radio:checked").data("chk", true);
				$("input:radio").click(
					function() {
						$(
							"input[name='" + $(this).attr("name")
									+ "']:radio").not(this)
							.removeData("chk");
						$(this).data("chk", !$(this).data("chk"));
						$(this).prop("checked", $(this).data("chk"));
					});
			});
	</script>
</body>
</html>